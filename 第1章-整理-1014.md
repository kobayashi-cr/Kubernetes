# 第1章 イントロダクション

<!-- はじめに から移動 ★ここから -->
## 身の回りのさまざまなサービスに使われている「Kubernetes」
<!-- 次の見出しと区別するのに適当に入れたため、書き換えをお願いいたします↑-->

あなたは普段、どのようなWebサービスを利用していますか？

朝起きてスマートフォンを開けば、SNSで友達の投稿をチェックし、ニュースサイトで最新の情報を確認する。昼休みには動画サイトでエンターテイメントを楽しみ、夕方にはオンラインショッピングで商品を購入する。夜には音楽ストリーミングサービスでお気に入りの曲を聴きながら、一日を終える。

これらのサービスは、私たちの生活に欠かせない存在となっています。しかし、これらのサービスがどのような技術によって支えられているのかを考えたことはありますか？

実は、あなたが日常的に利用している多くのWebサービスが、その裏側で**Kubernetes**という技術によって動いています。AWS、Google Cloud、Microsoft Azureなどのクラウドサービス、GitHub、Docker Hubなどの開発者向けサービス、さらにはNetflix、Spotify、Airbnbなど、私たちがよく知る多くの企業がKubernetesを活用してサービスを提供しているのです。
「知らないうちにKubernetesの恩恵を受けていた」と驚かれた方も多いのではないでしょうか。

<!-- ここまで★ -->


## Kubernetesとは？

**Kubernetes**とは、多数のコンテナを効率よく管理するための仕組み（オーケストレーションツール）です。

### コンテナとは？

まず、コンテナについて説明しましょう。

**コンテナ = アプリケーションを動かすための「箱」**

コンテナは、アプリケーションとその実行に必要な環境（OS、ライブラリ、設定ファイルなど）を1つにまとめた「箱」のようなものです。

#### コンテナの特徴
コンテナには次のような特徴があります。

- **独立性** - 各コンテナは独立して動作し、他のコンテナに影響しない
- **可搬性** - どこでも同じ環境で動作する
- **専門性** - 1つのアプリケーションに特化している
（ここに3つの特徴を説明するイラストを入れる）

#### 従来のサーバー運用との違い

**従来の方法（物理サーバー）** 

従来の方法では、1つのサーバーに複数のアプリケーションをインストールしていました。
この方法では、アプリケーション同士が影響し合う可能性があり、サーバーが壊れるとすべてのアプリケーションが停止してしまうという問題がありました。

**コンテナを使った方法**  

コンテナを使った方法では、1つのサーバーに複数のコンテナを配置します。
各コンテナは独立しているため互いに影響せず、1つのコンテナが壊れても他のコンテナは正常に動作し続けます。
また、コンテナは必要に応じて簡単に増減が可能になっています。
つまり、コンテナは、アプリケーションを「どこでも動く、独立した単位」として扱えるようにする技術なのです。


### Kubernetesの役割

Kubernetesは次のような重要な機能を自動で行ってくれます。

- **コンテナの自動復旧** - コンテナが停止したら自動で再起動
- **スケーリング** - 負荷に応じてコンテナ数を自動で増減
- **外部公開** - 外部からアクセスできるように自動で設定
- **分散配置** - 複数のサーバーにコンテナを効率的に配置
（ここに4つの特徴を説明するイラストを入れる）

つまり、大量のコンテナを「安全・効率的・止まらない」状態で運用するために欠かせない存在なのです。

## レストランの運営に例えて理解する

Kubernetesの役割を理解するために、レストランの運営に例えてみましょう。
Kubernetesとは、一言で言えば、レストランの総支配人のような存在なのです。
レストランで総支配人が果たす役割を考えてみてください。

- **シェフ（コンテナ）が倒れても、新しいシェフをすぐ補充して料理を継続できるようにする**
  - 1人のシェフが体調を崩しても、すぐに代わりのシェフを手配
  - お客さんは料理の提供が止まることなく、サービスを受け続けられる
  - これは、Webアプリケーションのコンテナが予期せず停止した場合に、Kubernetesが自動的に新しいコンテナを起動してサービスを継続させる仕組みに相当します

(ここにイラストを挿入)

- **調理台（Pod）の数を、お客さんの数に合わせて自動で増減できるようにする**
  - ランチタイムでお客さんが急増したら、調理台を増設
  - 夜の時間帯でお客さんが減ったら、調理台を減らしてコストを削減
  - これは、Webアプリケーションへのアクセス数が増えた場合に、Kubernetesが自動的にPod数を増やして負荷に対応し、アクセス数が減ったらPod数を減らしてリソースを効率化する仕組みに相当します

(ここにイラストを挿入)

- **厨房（Node）の空き状況を見ながら、どの調理台をどの厨房に置くかを判断する**
  - メイン厨房が混雑しているなら、サブ厨房に調理台を配置
  - 各厨房の負荷を均等に保ち、効率的に運営
  - これは、Kubernetesが各Worker Nodeのリソース使用状況を監視し、CPUやメモリの空きが多いNodeに新しいPodを配置して、クラスタ全体の負荷を均等に分散させる仕組みに相当します

(ここにイラストを挿入)

- **ホールスタッフ（Service）を通じて、お客さんが待たずに料理を受け取れるようにする**
  - お客さんは厨房の場所を覚える必要がない
  - ホールスタッフが注文した料理をお客さんに届ける
  - これは、ユーザーがWebアプリケーションにアクセスする際に、Podの場所を意識する必要がなく、Serviceが適切なPodにリクエストを転送し、複数のPod間で負荷分散を行う仕組みに相当します

(ここにイラストを挿入)

**総支配人がいなければレストランは混乱する**

もし総支配人がいなかったらどうなるでしょうか？
シェフが倒れても誰も気づかず料理が止まってしまい、お客さんが増えても調理台を増やせず待ち時間が長くなってしまいます。厨房の配置が非効率で無駄な動きが多くなり、お客さんは厨房を直接探さなければならず混乱してしまうでしょう。

(ここにイラストを挿入)

つまり、総支配人がいることで全体が調和し、効率よくお客さんに料理を提供できるようになります。
これがKubernetesの果たす役割です。Kubernetesは、コンテナという「シェフ」たちを効率的に管理し、サービスが止まらないように自動で調整してくれる「総支配人」なのです。

## Dockerとの違い

DockerとKubernetesは、どちらもコンテナ技術に関連していますが、それぞれ異なる役割を果たしています。この違いを理解することで、なぜKubernetesが必要なのかが分かります。

### Dockerの役割

Dockerは「コンテナを作って動かす」仕組みです。アプリケーションとその実行環境を1つのコンテナとしてパッケージ化し、どこでも同じように動作させることができます。
レストランの例でいうと、Dockerは「1人のシェフが1つの料理を作る」イメージです。シェフは自分の調理道具とレシピを持って、独立して料理を作ることができます。

### Dockerだけでは解決できない課題

しかし、1人のシェフに任せれば料理はできるものの、レストランとして運営するには以下のような課題が発生します。

**シェフが倒れたら誰が代わりを務めるのか？**

1人のシェフが体調を崩したり、休暇を取ったりした場合、料理が作れなくなってしまいます。Dockerでは、コンテナが停止した場合の自動復旧機能は提供されていません。

**お客さんが一気に増えたら、どうやってシェフを増やすのか？**

ランチタイムでお客さんが急増した場合、1人のシェフでは対応できません。Dockerでは、コンテナ数を手動で増やす必要があり、負荷に応じた自動スケーリングはできません。

**どの調理台で誰がどの料理を作るのかを誰が決めるのか？**

複数のシェフがいる場合、誰がどの料理を担当するか、どの調理台を使うかを管理する必要があります。Dockerでは、複数のコンテナを効率的に管理・調整する機能は限定的です。

**ホールスタッフがいないと、お客さんは厨房の場所を直接探さなければならない**

お客さんが直接厨房に行って料理を注文するのは非効率です。Dockerでは、複数のコンテナに適切にアクセスを振り分ける機能は標準では提供されていません。

### Kubernetesの役割

Kubernetesは「大量のコンテナを管理し、運用を自動化する」仕組みです。Dockerで作成したコンテナを、より効率的に運用するためのオーケストレーションツールです。
レストランの例でいうと、Kubernetesは「レストラン全体の運営を管理する総支配人」です。シェフ（コンテナ）の配置、調理台（Pod）の管理、ホールスタッフ（Service）の調整など、レストラン運営に必要なすべての要素を統合的に管理します。

### DockerとKubernetesの関係

DockerとKubernetesは対立する技術ではなく、相互に補完し合う関係にあります。

**Dockerが基盤**

Dockerは、コンテナを作成・実行するための基盤技術です。アプリケーションをコンテナ化し、どこでも同じように動作させることができます。

**Kubernetesがオーケストレーション**

Kubernetesは、Dockerで作成したコンテナを効率的に管理・運用するためのオーケストレーションツールです。複数のコンテナを協調させ、安定したサービスを提供します。

### まとめ

DockerとKubernetesは、どちらも重要ですが、役割が異なります。Dockerが「コンテナを作って動かす」基盤であり、Kubernetesが「その上のオーケストレーション」を担います。
レストランに例えると、Dockerは「1人前のシェフを作る技術」、Kubernetesは「レストラン全体を効率的に運営するシステム」という関係です。両者が組み合わさることで、安定したサービス提供が実現できるのです。
